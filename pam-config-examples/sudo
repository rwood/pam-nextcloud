# Example PAM configuration for sudo
# This file shows how to use pam_nextcloud for sudo authentication
#
# Copy this to /etc/pam.d/sudo or modify your existing sudo PAM configuration
#
# WARNING: Test this carefully! Incorrect sudo PAM configuration
# can lock you out of administrative access.

# Nextcloud authentication for sudo
auth    sufficient  pam_python.so pam_nextcloud.py

# Fallback to local Unix authentication
auth    sufficient  pam_unix.so try_first_pass
auth    required    pam_deny.so

# Account management
account required    pam_permit.so

# Session management
session required    pam_permit.so

