# Example PAM configuration for GDM (GNOME Display Manager)
# This file shows how to use pam_nextcloud for GNOME desktop login
# with GNOME Online Accounts integration
#
# Copy this to /etc/pam.d/gdm-password or modify your existing gdm PAM configuration

# Authentication
auth    sufficient  pam_python.so /lib/security/pam_nextcloud.py

# Include standard GNOME authentication stack
auth    requisite   pam_nologin.so
auth    sufficient  pam_unix.so nullok_secure try_first_pass
auth    required    pam_deny.so

# Account management
account sufficient  pam_python.so /lib/security/pam_nextcloud.py
account sufficient  pam_unix.so
account required    pam_permit.so

# Session management with GNOME Online Accounts integration
session optional    pam_python.so /lib/security/pam_nextcloud.py
session [success=ok ignore=ignore module_unknown=ignore default=bad] pam_selinux.so close
session required    pam_loginuid.so
session [success=ok ignore=ignore module_unknown=ignore default=bad] pam_selinux.so open
session optional    pam_keyinit.so force revoke
session required    pam_limits.so
session required    pam_unix.so
session optional    pam_gnome_keyring.so auto_start
session optional    pam_systemd.so

# Password management
password sufficient pam_python.so /lib/security/pam_nextcloud.py
password required   pam_unix.so use_authtok sha512 shadow

